
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>基本関数 · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.4">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="i_graph.html" />
    
    
    <link rel="prev" href="ex_macro.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">はじめに</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    目次
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="appendix.html">
            
                <a href="appendix.html">
            
                    
                    付録
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">リファレンス</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="i_prep.html">
            
                <a href="i_prep.html">
            
                    
                    プリプロセッサ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="sysval.html">
            
                <a href="sysval.html">
            
                    
                    システム変数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="i_prog.html">
            
                <a href="i_prog.html">
            
                    
                    プログラム制御
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="hspdef.html">
            
                <a href="hspdef.html">
            
                    
                    標準マクロ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="ex_macro.html">
            
                <a href="ex_macro.html">
            
                    
                    特殊マクロ
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.6" data-path="i_stdfunc.html">
            
                <a href="i_stdfunc.html">
            
                    
                    基本関数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="i_graph.html">
            
                <a href="i_graph.html">
            
                    
                    画面制御
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="i_object.html">
            
                <a href="i_object.html">
            
                    
                    オブジェクト
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="i_string.html">
            
                <a href="i_string.html">
            
                    
                    文字列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="hspmath.html">
            
                <a href="hspmath.html">
            
                    
                    数学
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="i_stdio.html">
            
                <a href="i_stdio.html">
            
                    
                    入出力
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="i_file.html">
            
                <a href="i_file.html">
            
                    
                    ファイル
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="i_mem.html">
            
                <a href="i_mem.html">
            
                    
                    メモリ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="i_mmedia.html">
            
                <a href="i_mmedia.html">
            
                    
                    マルチメディア
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="i_hsp3util.html">
            
                <a href="i_hsp3util.html">
            
                    
                    ユーティリティ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="hspsock.html">
            
                <a href="hspsock.html">
            
                    
                    ソケット通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="sprite.html">
            
                <a href="sprite.html">
            
                    
                    スプライト
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="hsp3dish.html">
            
                <a href="hsp3dish.html">
            
                    
                    HSP3Dish
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="hgimg_common.html">
            
                <a href="hgimg_common.html">
            
                    
                    HGIMG4共通
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="hgimg4.html">
            
                <a href="hgimg4.html">
            
                    
                    HGIMG4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.21" data-path="obaq.html">
            
                <a href="obaq.html">
            
                    
                    OBAQ
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="hsp3.tv">
            
                <span>
            
                    
                    公式サイト
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >基本関数</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="基本関数">基本関数</h1>
<p><strong>対応</strong>:</p>
<ul>
<li>Win</li>
<li>Cli</li>
<li>Let</li>
</ul>
<h2 id="int">int </h2>
<p>整数値に変換</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 変換元の値または変数</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された値を整数にしたものを返します。
値が実数の場合は、小数点以下が切り捨てられます。
値が文字列の場合は、数値文字列の場合はその数値に、 それ以外は0になります。</p>
<p><strong>参照</strong>:</p>
<p>str
double</p>
<h2 id="rnd">rnd </h2>
<p>乱数を発生</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=1〜32768 : 乱数の範囲</p>
<p><strong>説明</strong>:</p>
<p>0から(p1-1)の範囲で整数の乱数値を発生させます。
p1の値は範囲に含まれません。たとえば、</p>
<pre><code>
例 ：
    a=rnd(10)
</code></pre><p>は、変数aに、0〜9までの乱数を代入します。
rnd関数は、プログラム起動してからは一定のパターンで乱数を発生させます。
乱数のパターンを一定でないものにする場合は、 randomize命令を使用してください。</p>
<p><strong>参照</strong>:</p>
<p>randomize</p>
<h2 id="strlen">strlen </h2>
<p>文字列の長さを調べる</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 文字列の長さを調べたい文字列かまたは文字列型の変数名</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された文字列または、文字列型変数が持っている文字列の長さ(メモリサイズ)を返します。
文字列に全角文字(日本語)が含まれる場合は、1文字でも2文字分に計算されます。
(ただしHSP64,UTF-8ランタイムの場合は文字の長さが異なる場合があります)</p>
<p><strong>参照</strong>:</p>
<h2 id="length">length </h2>
<p>配列の1次元要素数を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 配列を調べる変数</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された変数が持つ配列要素数(1次元)を返します。
配列要素数が５だった場合は、p1(0)〜p1(4)が存在することになります。</p>
<p><strong>参照</strong>:</p>
<p>length2
length3
length4</p>
<h2 id="length2">length2 </h2>
<p>配列の2次元要素数を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 配列を調べる変数</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された変数が持つ配列要素数(2次元)を返します。
配列要素数が５だった場合は、p1(0,0)〜p1(?,4)が存在することになります。
配列の次元が存在しない場合は、0が返ります。</p>
<p><strong>参照</strong>:</p>
<p>length
length3
length4</p>
<h2 id="length3">length3 </h2>
<p>配列の3次元要素数を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 配列を調べる変数</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された変数が持つ配列要素数(3次元)を返します。
配列要素数が５だった場合は、p1(0,0,0)〜p1(?,?,4)が存在することになります。配列の次元が存在しない場合は、0が返ります。</p>
<p><strong>参照</strong>:</p>
<p>length
length2
length4</p>
<h2 id="length4">length4 </h2>
<p>配列の4次元要素数を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 配列を調べる変数</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された変数が持つ配列要素数(4次元)を返します。
配列要素数が５だった場合は、p1(0,0,0,0)〜p1(?,?,?,4)が存在することになります。配列の次元が存在しない場合は、0が返ります。</p>
<p><strong>参照</strong>:</p>
<p>length
length2
length3</p>
<h2 id="vartype">vartype </h2>
<p>変数の型を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 型を調べる変数、または文字列</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された変数が格納している値の型を調べて返します。
返される値は、型を示す整数値となります。型の値は、以下の通りです。</p>
<pre><code>
 1 : ラベル型
 2 : 文字列型
 3 : 実数型
 4 : 整数型
 5 : モジュール型
 6 : COMオブジェクト型
</code></pre><p>プラグイン等で型が拡張されている場合は、これ以外の値が返されます。
また、p1に文字列を指定した場合には、型を示す型名として扱われます。
型名は、登録されているものと大文字小文字を含めて完全に一致させる必要があります。</p>
<pre><code>
&quot;int&quot;    : 整数型
&quot;str&quot;    : 文字列型
&quot;double&quot; : 実数型
&quot;struct&quot; : モジュール型
</code></pre><p>標準的な型名として、使用できるも文字列は上の通りです。ただし、これ以外にもプラグイン等で型が拡張されている場合は、指定できる型名も追加されます。</p>
<p><strong>参照</strong>:</p>
<p>varptr
varsize</p>
<h2 id="varptr">varptr </h2>
<p>変数データのポインタを返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : ポインタを調べる変数、または命令</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された変数が格納しているデータがあるメモリアドレスを返します。
p1に外部拡張命令(#funcで定義されているDLL呼び出し用の命令)を指定した場合には、実際に実行される外部関数のアドレスを返します。
この関数は、 外部DLLにポインタを渡したい時など特殊な場合に使用するもので、通常は覚えておく必要のないものです。
varptrによって取得したポインタは、配列の拡張や内容の更新などにより変化する可能性があるため、値を参照する直前で使用するようにしてください。</p>
<p><strong>参照</strong>:</p>
<p>varsize
vartype
libptr</p>
<p><strong>非対応</strong>:</p>
<ul>
<li>Let</li>
</ul>
<h2 id="varsize">varsize </h2>
<p>変数データのバッファサイズを返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : バッファサイズを調べる変数</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された変数が格納しているデータのバッファサイズ(確保されているメモリサイズ)を返します。
varsizeによって取得したサイズは、内容の更新などにより変化する可能性があるため、値を参照する直前で使用するようにしてください。</p>
<p><strong>参照</strong>:</p>
<p>varptr
vartype
libptr</p>
<p><strong>非対応</strong>:</p>
<ul>
<li>Let</li>
</ul>
<h2 id="gettime">gettime </h2>
<p>時間・日付を取得する</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=0〜7(0) : 取得するタイプ</p>
<p><strong>説明</strong>:</p>
<p>p1で指定したタイプの日付・時刻情報を返します。
取得するタイプは以下の通りです。</p>
<pre><code>
    0 : 年(Year)
    1 : 月(Month)
    2 : 曜日(DayOfWeek)
    3 : 日(Day)
    4 : 時(Hour)
    5 : 分(Minute)
    6 : 秒(Second)
    7 : ミリ秒(Milliseconds)
</code></pre><p>たとえば、</p>
<pre><code>
例 ：
    a=gettime(4)   ; いま何時?
</code></pre><p>は、変数aに現在時刻が何時かを代入します。</p>
<p><strong>参照</strong>:</p>
<h2 id="str">str </h2>
<p>文字列に変換</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 変換元の値または変数</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された値を文字列にしたものを返します。</p>
<p><strong>参照</strong>:</p>
<p>int
double</p>
<h2 id="dirinfo">dirinfo </h2>
<p>ディレクトリ情報の取得</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=0〜5 : 取得するタイプ</p>
<p><strong>説明</strong>:</p>
<p>p1で指定したタイプのディレクトリ名を返します。
取得するタイプは以下の通りです。</p>
<pre><code>
    0 : カレント(現在の)ディレクトリ(dir_cur)
    1 : HSPの実行ファイルがあるディレクトリ(dir_exe)
    2 : Windowsディレクトリ(dir_win)
    3 : Windowsのシステムディレクトリ(dir_sys)
    4 : コマンドライン文字列(dir_cmdline)
    5 : HSPTVディレクトリ(dir_tv)
</code></pre><p>p1を省略することはできません。
また、p1に0x10000以上の値を指定した場合は、ビット0〜15までをCSIDL値として特殊フォルダの取得を行ないます。
これにより、デスクトップ(0x10000)やマイドキュメント(0x10005)等のシステムが管理しているほとんどのフォルダを取得することができます。
通常は、hspdef.as内で定義されてる「dir_*」マクロを通してご使用ください。</p>
<p><strong>参照</strong>:</p>
<p>dir_cur
dir_exe
dir_win
dir_sys
dir_cmdline
dir_tv</p>
<h2 id="double">double </h2>
<p>実数値に変換</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 変換元の値または変数</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された値を実数にしたものを返します。
値が文字列の場合は、数値文字列の場合はその数値に、 それ以外は0になります。</p>
<p><strong>参照</strong>:</p>
<p>int
str</p>
<h2 id="sin">sin </h2>
<p>サイン値を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=(0.0) : 角度値(ラジアン)</p>
<p><strong>説明</strong>:</p>
<p>p1のサイン(正弦)値を実数で返します。
p1で指定する単位はラジアン(2πが360度)になります。</p>
<p><strong>参照</strong>:</p>
<p>cos
tan
atan</p>
<h2 id="cos">cos </h2>
<p>コサイン値を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=(0.0) : 角度値(ラジアン)</p>
<p><strong>説明</strong>:</p>
<p>p1のコサイン(余弦)値を実数で返します。
p1で指定する単位はラジアン(2πが360度)になります。</p>
<p><strong>参照</strong>:</p>
<p>sin
tan
atan</p>
<h2 id="tan">tan </h2>
<p>タンジェント値を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=(0.0) : 角度値(ラジアン)</p>
<p><strong>説明</strong>:</p>
<p>p1のタンジェント(正接)値を実数で返します。
p1で指定する単位はラジアン(2πが360度)になります。</p>
<p><strong>参照</strong>:</p>
<p>sin
cos
atan</p>
<h2 id="atan">atan </h2>
<p>アークタンジェント値を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2)
p1      : Y値
p2(1.0) : X値</p>
<p><strong>説明</strong>:</p>
<p>p1をY、p2をXの値として、 Y/Xの角度(アークタンジェント値)を実数のラジアン単位(2πが360度)で返します。
p2を省略した場合は1.0が使用されます。</p>
<p><strong>参照</strong>:</p>
<p>sin
cos
tan</p>
<h2 id="sqrt">sqrt </h2>
<p>ルート値を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=0.0〜(0.0) : ルートを求める値</p>
<p><strong>説明</strong>:</p>
<p>p1のルート(平方根)値を、実数で返します。
p1にマイナス値を指定することはできません。</p>
<p><strong>参照</strong>:</p>
<h2 id="sysinfo">sysinfo </h2>
<p>システム情報の取得</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=0〜 : 取得するタイプ</p>
<p><strong>説明</strong>:</p>
<p>p1で指定したタイプのシステム情報値を返します。
取得できるタイプは以下の通りです。</p>
<pre><code>
  0 : 文字列 OS名とバージョン番号
  1 : 文字列 ログイン中のユーザー名
  2 : 文字列 ネットワーク上のコンピュータ名
  3 : 数値 HSPが使用する言語(0=英語/1=日本語)
 16 : 数値 使用しているCPUの種類(コード)
 17 : 数値 使用しているCPUの数
 33 : 数値 物理メモリサイズの使用量(単位%)
 34 : 数値 全体の物理メモリサイズ
 35 : 数値 空き物理メモリサイズ
 36 : 数値 スワップファイルのトータルサイズ
 37 : 数値 スワップファイルの空きサイズ
 38 : 数値 仮想メモリを含めた全メモリサイズ
 39 : 数値 仮想メモリを含めた空きメモリサイズ
</code></pre><p><strong>参照</strong>:</p>
<h2 id="peek">peek </h2>
<p>バッファから1byte読み出し</p>
<p><strong>グループ</strong>:</p>
<p>メモリ管理関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2)
p1=変数 : 内容を読み出す元の変数名
p2=0〜  : バッファのインデックス(Byte単位)</p>
<p><strong>説明</strong>:</p>
<p>変数に保存されたデータメモリ上の任意の場所にある1バイト(8bit)の内容を数値として返します。
関数の戻り値は、0〜255までの整数値になります。</p>
<p><strong>参照</strong>:</p>
<p>wpeek
lpeek</p>
<h2 id="wpeek">wpeek </h2>
<p>バッファから2byte読み出し</p>
<p><strong>グループ</strong>:</p>
<p>メモリ管理関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2)
p1=変数 : 内容を読み出す元の変数名
p2=0〜  : バッファのインデックス(Byte単位)</p>
<p><strong>説明</strong>:</p>
<p>変数に保存されたデータメモリ上の任意の場所にある2バイト(16bit)の内容を数値として返します。
関数の戻り値は、0〜65535までの整数値になります。</p>
<p><strong>参照</strong>:</p>
<p>peek
lpeek</p>
<h2 id="lpeek">lpeek </h2>
<p>バッファから4byte読み出し</p>
<p><strong>グループ</strong>:</p>
<p>メモリ管理関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2)
p1=変数 : 内容を読み出す元の変数名
p2=0〜  : バッファのインデックス(Byte単位)</p>
<p><strong>説明</strong>:</p>
<p>変数に保存されたデータメモリ上の任意の場所にある4バイト(32bit)の内容を数値として返します。
関数の戻り値は、0〜$ffffffffまでの整数値になります。</p>
<p><strong>参照</strong>:</p>
<p>peek
wpeek</p>
<h2 id="callfunc">callfunc </h2>
<p>外部関数の呼び出し</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2,p3)
p1 : パラメーターが格納されている配列変数
p2 : 関数アドレス
p3 : パラメーター数</p>
<p><strong>説明</strong>:</p>
<p>p2で指定されているアドレスをネイティブな関数として呼び出します。
呼び出しの引数として、p1で指定された数値型配列変数に格納されている値を使用します。p3でパラメーター数を指定することができます。</p>
<pre><code>
例 :
    a.0=1
    a.1=2
    a.2=3
    res = callfunc( a, proc, 3 )
</code></pre><p>上の例では、procが示すアドレスの関数を(1,2,3)という引数で呼び出します。
呼び出した関数の戻り値が、そのままcallfuncの戻り値となります。
この関数は、自前で関数アドレスを用意して呼び出す特殊な状況に使用するものです。
通常は使用する必要がありません。また、外部関数呼び出しに失敗した場合には、フリーズや予期しない結果が起こる場合があるので、十分に注意して使用するようにしてください。</p>
<p><strong>参照</strong>:</p>
<h1 id="uselib">uselib</h1>
<h1 id="func">func</h1>
<h2 id="absf">absf </h2>
<p>実数の絶対値を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 絶対値に変換する実数値</p>
<p><strong>説明</strong>:</p>
<p>p1の絶対値を実数で返します。
整数の絶対値が必要な場合は、abs関数を使用してください。</p>
<p><strong>参照</strong>:</p>
<p>abs</p>
<h2 id="abs">abs </h2>
<p>整数の絶対値を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 絶対値に変換する整数値</p>
<p><strong>説明</strong>:</p>
<p>p1の絶対値を整数で返します。
実数の絶対値が必要な場合は、absf関数を使用してください。</p>
<p><strong>参照</strong>:</p>
<p>absf</p>
<h2 id="logf">logf </h2>
<p>対数を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=0.0〜(0.0) : 対数を求める値</p>
<p><strong>説明</strong>:</p>
<p>p1の対数(log)値を、実数で返します。
p1に0を指定した場合は無限大(INF)を返します。</p>
<p><strong>参照</strong>:</p>
<p>expf</p>
<h2 id="expf">expf </h2>
<p>指数を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1=0.0〜(0.0) : 指数を求める値</p>
<p><strong>説明</strong>:</p>
<p>p1の指数(exp)値を、実数で返します。
オーバーフローした場合は無限(INF)を返し、アンダーフローした場合は0を返します。</p>
<p><strong>参照</strong>:</p>
<p>logf</p>
<h2 id="limit">limit </h2>
<p>一定範囲内の整数を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2,p3)
p1 : 対象となる値
p2 : 最小値
p3 : 最大値</p>
<p><strong>説明</strong>:</p>
<p>p1に指定した値を、p2〜p3の範囲内に収まる整数に変換したものを返します。
p1の値がp2よりも小さい場合は、p2の値が返され、p1の値がp3よりも大きい場合にはp3の値が返されます。
これにより、limit関数が返す値は、必ずp2〜p3の範囲内となります。
p2パラメーターを省略した場合は、最小値の制限を行ないません。
p3パラメーターを省略した場合は、最大値の制限を行ないません。
実数の範囲を求める場合には、limitf関数を使用してください。</p>
<p><strong>参照</strong>:</p>
<p>limitf</p>
<h2 id="limitf">limitf </h2>
<p>一定範囲内の実数を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2,p3)
p1 : 対象となる値
p2 : 最小値
p3 : 最大値</p>
<p><strong>説明</strong>:</p>
<p>p1に指定した値を、p2〜p3の範囲内に収まる実数に変換したものを返します。
p1の値がp2よりも小さい場合は、p2の値が返され、p1の値がp3よりも大きい場合にはp3の値が返されます。
これにより、limitf関数が返す値は、必ずp2〜p3の範囲内となります。
p2パラメーターを省略した場合は、最小値の制限を行ないません。
p3パラメーターを省略した場合は、最大値の制限を行ないません。
整数の範囲を求める場合には、limit関数を使用してください。</p>
<p><strong>参照</strong>:</p>
<p>limit</p>
<h2 id="varuse">varuse </h2>
<p>変数の使用状況を返す</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : 使用状況を調べる変数</p>
<p><strong>説明</strong>:</p>
<p>p1に指定した変数の使用状況を返します。
varuseは、モジュール型やCOMオブジェクト型の変数など、 実態を持たない状況が発生する場合にのみ有効です。
指定された変数が有効であれば1を、そうでなければ0を返します。
モジュール型変数であれば、未使用(0)か、初期化済み(1)、または他の変数のクローン(2)かどうかを調べることができます。
COMオブジェクト型であれば、有効なCOMオブジェクトを保持しているかを調べられます。</p>
<p><strong>参照</strong>:</p>
<p>newmod
delmod</p>
<p><strong>非対応</strong>:</p>
<ul>
<li>Let</li>
</ul>
<h2 id="libptr">libptr </h2>
<p>外部呼出しコマンドの情報アドレスを得る</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1 : アドレスを調べるコマンド</p>
<p><strong>説明</strong>:</p>
<p>p1に指定したコマンドの情報アドレスを取得して整数値として返します。
外部DLL呼び出しコマンドや関数をパラメーターとして指定することで、コマンドに関する情報が格納されているSTRUCTDAT構造体のアドレスを取得することができます。
STRUCTDAT構造体は、HSPSDK内で以下のように定義されています。</p>
<pre><code>
    typedef struct STRUCTDAT {
    short    index;           // base LIBDAT index
    short    subid;           // struct index
    int    prmindex;            // STRUCTPRM index(MINFO)
    int    prmmax;              // number of STRUCTPRM
    int    nameidx;             // name index (DS)
    int    size;                // struct size (stack)
    int    otindex;             // OT index(Module)  / cleanup flag(Dll)
    union {
        void    *proc;       // proc address
        int    funcflag;        // function flags(Module)
    };
    } STRUCTDAT;
</code></pre><p>p1にCOM呼び出しコマンドやユーザー定義命令、 ユーザー定義関数を指定した場合も同様にSTRUCTDAT構造体のアドレスが取得されます。
libptr関数は、HSPが使用している内部データへのアクセスを補助するもので、ここで扱う情報の内容について十分な知識を持った上で使用するようにしてください。
通常の使用範囲では、この関数を利用したり覚えておく必要はありません。</p>
<p>STRUCTDAT構造体を参照することで、 外部呼出しDLLのアドレスや、DLLハンドルなどの情報を得ることが可能です。</p>
<p><strong>参照</strong>:</p>
<p>varptr</p>
<p><strong>例</strong>:</p>
<pre><code>#uselib &quot;user32.dll&quot;
#func MessageBoxA &quot;MessageBoxA&quot; int,sptr,sptr,int

ladr=libptr( MessageBoxA )
dupptr lptr,ladr,28    ; STRUCTDAT構造体を取得
lib_id=wpeek(lptr,0)
mes &quot;LIB#&quot;+lib_id
mref hspctx,68
linf_adr=lpeek( hspctx, 832 )
dupptr linf,linf_adr + lib_id*16,16    ; LIBDAT構造体を取得
dll_flag = linf(0)
dll_name = linf(1)
dll_handle = linf(2)
mes &quot;FLAG(&quot;+dll_flag+&quot;) NAME_ID#&quot;+dll_name
mes &quot;HANDLE=&quot;+strf(&quot;%x&quot;,dll_handle)
stop
</code></pre><p><strong>非対応</strong>:</p>
<ul>
<li>Let</li>
</ul>
<h2 id="comevdisp">comevdisp </h2>
<p>COMイベントの内容を確認</p>
<p><strong>グループ</strong>:</p>
<p>COMオブジェクト操作関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1)
p1      : 変数名</p>
<p><strong>説明</strong>:</p>
<p>p1で指定された変数(COMオブジェクト型)のイベントサブルーチン内で、イベントのディスパッチID(DISPID)を取得します。
p1で指定された変数は、comevent命令により初期化されている必要があります。
また、取得は必ずイベントサブルーチン内で行なう必要があります。</p>
<p><strong>参照</strong>:</p>
<p>comevent
comevarg</p>
<p><strong>非対応</strong>:</p>
<ul>
<li>Let</li>
</ul>
<h2 id="powf">powf </h2>
<p>累乗（べき乗）を求める</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1, p2)
p1 : 底（0以上）
p2 : 指数</p>
<p><strong>説明</strong>:</p>
<p>p1をp2乗した値を求めます。結果は実数で与えられます。
p1は必ず正でなければなりません。負の場合はエラーにはなりませんが、非数（-1.#IND00）が返ります。
p2は正負どちらでも構いません。また、実数を指定することも可能です。</p>
<p><strong>例</strong>:</p>
<pre><code>repeat 5, -2
    mes &quot;10の&quot; + cnt + &quot;乗は&quot; + powf(10, cnt) + &quot;です。&quot;
loop
stop
</code></pre><p><strong>非対応</strong>:</p>
<ul>
<li>Let</li>
</ul>
<h2 id="getease">getease </h2>
<p>イージング値を整数で取得</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2)
p1(0) : 時間経過値(整数値)
p2(4096) : 時間経過値の最大(整数値)</p>
<p><strong>説明</strong>:</p>
<p>決められた範囲の数値を任意の計算式で補間するイージング関数の計算結果値を整数で取得します。
イージング関数を使用する際には、必ず先にsetease命令により出力される最小値、最大値および計算式を設定しておく必要があります。
p1で指定する時間経過値は、0から始まる整数値で、時間経過値の最大(p2パラメーター)までを指定することで、イージング関数の計算結果を返します。
最大値(p2パラメーター)を省略した場合は、4096が使用されます。
通常は、時間経過値がマイナスの値だった場合は、0とみなされます。また、時間経過値が最大値(p2パラメーター)を超えた場合も、最大値として扱われます。
(ただし、setease命令による計算式のタイプ設定で、ease_loop(補間のループ)を加算した場合は、範囲外の値も含めて補間のループ(繰り返し)を行ないます。)</p>
<p><strong>参照</strong>:</p>
<p>setease
geteasef</p>
<p><strong>非対応</strong>:</p>
<ul>
<li>Let</li>
</ul>
<h2 id="geteasef">geteasef </h2>
<p>イージング値を実数で取得</p>
<p><strong>グループ</strong>:</p>
<p>基本入出力関数</p>
<p><strong>パラメーター</strong>:</p>
<p>(p1,p2)
p1(0) : 時間経過値(実数値)
p2(1.0) : 時間経過値の最大(実数値)</p>
<p><strong>説明</strong>:</p>
<p>決められた範囲の数値を任意の計算式で補間するイージング関数の計算結果値を実数で取得します。
イージング関数を使用する際には、必ず先にsetease命令により出力される最小値、最大値および計算式を設定しておく必要があります。
p1で指定する時間経過値は、0から始まる実数値で、時間経過値の最大(p2パラメーター)までを指定することで、イージング関数の計算結果を返します。
最大値(p2パラメーター)を省略した場合は、1.0が使用されます。
通常は、時間経過値がマイナスの値だった場合は、0とみなされます。また、時間経過値が最大値(p2パラメーター)を超えた場合も、最大値として扱われます。
(ただし、setease命令による計算式のタイプ設定で、ease_loop(補間のループ)を加算した場合は、範囲外の値も含めて補間のループ(繰り返し)を行ないます。)
geteasef命令はより細かいイージング関数の計算結果を取得します。通常の座標値など整数で渡される値を取得する場合は、getease関数を使用した方が高速になります。</p>
<p><strong>参照</strong>:</p>
<p>setease
getease</p>
<p><strong>非対応</strong>:</p>
<ul>
<li>Let</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="ex_macro.html" class="navigation navigation-prev " aria-label="Previous page: 特殊マクロ">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="i_graph.html" class="navigation navigation-next " aria-label="Next page: 画面制御">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"基本関数","level":"2.6","depth":1,"next":{"title":"画面制御","level":"2.7","depth":1,"path":"i_graph.md","ref":"i_graph.md","articles":[]},"previous":{"title":"特殊マクロ","level":"2.5","depth":1,"path":"ex_macro.md","ref":"ex_macro.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"i_stdfunc.md","mtime":"2022-10-27T04:52:17.153Z","type":"markdown"},"gitbook":{"version":"4.0.4","time":"2022-11-01T05:57:12.343Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

