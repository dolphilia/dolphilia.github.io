import{_ as s,o as a,c as p,Q as n}from"./chunks/framework.43c433ff.js";const h=JSON.parse('{"title":"マルチメディア","description":"","frontmatter":{},"headers":[],"relativePath":"translation/hsp/i_mmedia.md","filePath":"translation/hsp/i_mmedia.md","lastUpdated":1676126774000}'),e={name:"translation/hsp/i_mmedia.md"},l=n(`<h1 id="マルチメディア" tabindex="-1">マルチメディア <a class="header-anchor" href="#マルチメディア" aria-label="Permalink to &quot;マルチメディア&quot;">​</a></h1><p><strong>対応</strong>:</p><ul><li>Win</li><li>Let</li></ul><h2 id="mci" tabindex="-1">mci <a class="header-anchor" href="#mci" aria-label="Permalink to &quot;mci {#mci}&quot;">​</a></h2><p>MCIにコマンドを送る</p><p><strong>グループ</strong>:</p><p>マルチメディア制御命令</p><p><strong>パラメーター</strong>:</p><p>&quot;strings&quot; &quot;strings&quot; : MCIコマンド文字列</p><p><strong>説明</strong>:</p><p>MCI（Multimedia Control Interface）にコマンド文字列を送ります。MCIに対応したMIDI再生、ムービー再生などを行なうことができます。</p><p>MCIコマンドの詳細については、Windows MCIの解説書をお読みください。ここでは簡単な使用法だけを紹介しておきます。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">mci &quot;play filename&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">mci &quot;play filename&quot;</span></span></code></pre></div><p>で、&quot;filename&quot;のファイルを再生します。たとえば、&quot;play aaaa.mid&quot;ならば、&quot;aaaa.mid&quot; というMIDIファイルを演奏します。拡張子がaviなら動画の再生、wavならPCMの再生、その他MCIに登録されているデバイスを再生することができます。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">mci &quot;open filename alias abc&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">mci &quot;open filename alias abc&quot;</span></span></code></pre></div><p>で、&quot;filename&quot;のファイルをオープンして、これ以降 &quot;abc&quot;という名前をエイリアスにすることができます。この後で、</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">mci &quot;play abc&quot;    ; デバイスの再生</span></span>
<span class="line"><span style="color:#e1e4e8;">	mci &quot;stop abc&quot;    ; デバイスの再生ストップ</span></span>
<span class="line"><span style="color:#e1e4e8;">	mci &quot;close abc&quot;   ; デバイスのクローズ</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">mci &quot;play abc&quot;    ; デバイスの再生</span></span>
<span class="line"><span style="color:#24292e;">	mci &quot;stop abc&quot;    ; デバイスの再生ストップ</span></span>
<span class="line"><span style="color:#24292e;">	mci &quot;close abc&quot;   ; デバイスのクローズ</span></span></code></pre></div><p>などの指定をすることができるようになります。 mciに命令を送った場合の結果はシステム変数 statに反映されます。 stat が-1の場合は、mci命令を解釈する時点でエラーが出ていることを示しています。また、mciでステータスを読み出すコマンドを送った場合も、stat に結果が反映されます。 MCIにコマンドは、Windowsプラットフォーム上でのみ動作します。HSP3Dish環境では使用できませんのでご注意ください。</p><p><strong>対応の補足</strong>:</p><p>HSPLet時は、以下の命令のみサポートされます。</p><p>open file alias name play name seek name to position status name position stop name close name</p><p>WAV/AIFF/AU/MIDI/MP3 をサポートしています。 MP3の再生には付属の jl1.0.jar が必要です。</p><h2 id="mmplay" tabindex="-1">mmplay <a class="header-anchor" href="#mmplay" aria-label="Permalink to &quot;mmplay {#mmplay}&quot;">​</a></h2><p>メディア再生</p><p><strong>グループ</strong>:</p><p>マルチメディア制御命令</p><p><strong>パラメーター</strong>:</p><p>p1 p1=0〜(0) : 再生するメディアバッファID</p><p><strong>説明</strong>:</p><p>mmload命令によって読み込まれたメディアを再生します。 p1でメディアバッファIDを指定することで、mmload命令によって読み込まれた複数のメディアから、どれを再生するかを選びます。</p><p>mmplay命令は、 通常メディアの再生がスタートするとともにHSPは次の命令へと進みます。 ただし、mmload命令で読み込みモード２を指定している場合は、メディアの再生が終了するまで次の命令へは進まなくなります。</p><p>すでにメディアが再生されている状態で、さらにmmplay命令を実行すると、前のメディア再生を終了してから、新しく指定したメディアの再生を始めます。 ただし、MIDIの再生中にPCMを再生するなど異なるデバイスの場合は、 再生が中止されることはありません。</p><p>AVI(動画)の再生は、 mmplay命令が実行された時点で操作先となっているウインドウのカレントポジションを左上として表示されます。 ただし、 mmload命令のモードに+16(ウィンドウ全体で再生)が指定されている場合は、ウィンドウの表示面いっぱいに再生されます。 この場合、画面サイズや縦横の比率には関係なくウィンドウのサイズに変倍されるので、あらかじめ動画の画面サイズや縦横比を考えた上で利用して下さい。</p><p><strong>参照</strong>:</p><p>mmload mmstop</p><h2 id="mmload" tabindex="-1">mmload <a class="header-anchor" href="#mmload" aria-label="Permalink to &quot;mmload {#mmload}&quot;">​</a></h2><p>メディアファイル読み込み</p><p><strong>グループ</strong>:</p><p>マルチメディア制御命令</p><p><strong>パラメーター</strong>:</p><p>&quot;filename&quot;,p1,p2 p1=0〜(0) : 割り当てるメディアバッファID p2=0〜2(0) : 割り当てるモード</p><p><strong>説明</strong>:</p><p>メディアデータのファイルを登録します。 読み込むことができる形式は以下の通りです。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">WAV形式  : 拡張子 WAV         : Windows標準のPCM音声データ。</span></span>
<span class="line"><span style="color:#e1e4e8;">AVI形式  : 拡張子 AVI         : Windows標準の動画データ</span></span>
<span class="line"><span style="color:#e1e4e8;">MID形式  : 拡張子 MID         : 標準MIDIファイルデータ。(*)</span></span>
<span class="line"><span style="color:#e1e4e8;">MP3形式  : 拡張子 MP3         : MP3形式音声データ</span></span>
<span class="line"><span style="color:#e1e4e8;">ASF形式  : 拡張子 ASF,WMV,WMA : Windows Media形式音声データ(*)</span></span>
<span class="line"><span style="color:#e1e4e8;">MPEG形式 : 拡張子 MPG         : MPEG形式動画データ(*)</span></span>
<span class="line"><span style="color:#e1e4e8;">オーディオCD : ファイル名 &quot;CD : トラック番号&quot; :</span></span>
<span class="line"><span style="color:#e1e4e8;">               (CDの音声トラック部分が対象になります)(*)</span></span>
<span class="line"><span style="color:#e1e4e8;">(*)の形式は、Windowsプラットフォーム上でのみ動作します</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">WAV形式  : 拡張子 WAV         : Windows標準のPCM音声データ。</span></span>
<span class="line"><span style="color:#24292e;">AVI形式  : 拡張子 AVI         : Windows標準の動画データ</span></span>
<span class="line"><span style="color:#24292e;">MID形式  : 拡張子 MID         : 標準MIDIファイルデータ。(*)</span></span>
<span class="line"><span style="color:#24292e;">MP3形式  : 拡張子 MP3         : MP3形式音声データ</span></span>
<span class="line"><span style="color:#24292e;">ASF形式  : 拡張子 ASF,WMV,WMA : Windows Media形式音声データ(*)</span></span>
<span class="line"><span style="color:#24292e;">MPEG形式 : 拡張子 MPG         : MPEG形式動画データ(*)</span></span>
<span class="line"><span style="color:#24292e;">オーディオCD : ファイル名 &quot;CD : トラック番号&quot; :</span></span>
<span class="line"><span style="color:#24292e;">               (CDの音声トラック部分が対象になります)(*)</span></span>
<span class="line"><span style="color:#24292e;">(*)の形式は、Windowsプラットフォーム上でのみ動作します</span></span></code></pre></div><p>たとえば、オーディオCDのトラック3を指定する場合は、</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">mmload &quot;CD:3&quot;,1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">mmload &quot;CD:3&quot;,1</span></span></code></pre></div><p>のようにします。 p1は、割り当てるメディアバッファIDとなります。これは、再生する時に必要となる0以上の整数値です。 複数のメディアファイルを取り扱うには、別々のバッファ番号に割り当てをしておく必要があります。 mmload命令は、指定されたファイルが2MB以下の音声(WAV)ファイルの場合は、メモリに内容を読み込んでおきリアルタイムに再生可能な状態にします。それ以外の場合は、ファイル名だけが登録され、実際のファイルの読み出しはメディア再生時(mmplay実行時)に行なわれることになります。</p><p>p2はモードを設定します。以下の値を指定することができます。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">モード0   : 指定したファイルは通常の再生を行う</span></span>
<span class="line"><span style="color:#e1e4e8;">モード1   : 指定したファイルは無限ループで再生を行う</span></span>
<span class="line"><span style="color:#e1e4e8;">モード2   : 指定したファイルは再生終了まで待つ</span></span>
<span class="line"><span style="color:#e1e4e8;">モード3   : (CDのみ)指定されたトラック以降を再生する</span></span>
<span class="line"><span style="color:#e1e4e8;">モード+16 : (AVIのみ)対象ウィンドウ全体で再生</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">モード0   : 指定したファイルは通常の再生を行う</span></span>
<span class="line"><span style="color:#24292e;">モード1   : 指定したファイルは無限ループで再生を行う</span></span>
<span class="line"><span style="color:#24292e;">モード2   : 指定したファイルは再生終了まで待つ</span></span>
<span class="line"><span style="color:#24292e;">モード3   : (CDのみ)指定されたトラック以降を再生する</span></span>
<span class="line"><span style="color:#24292e;">モード+16 : (AVIのみ)対象ウィンドウ全体で再生</span></span></code></pre></div><p>モード２を指定すると、指定したファイルが再生された場合、 HSPはその再生が終了するまで次の命令を実行しなくなります。 mmload命令はデータの情報をメモリ上にストックしておくだけで、すぐに演奏が始まるわけではありません。</p><p>モード+16は、AVI(動画)ファイルでのみ使用できるモードです。 モード0〜2に16を足した値を指定することで、表示対象になっているウインドウのサイズいっぱいに動画が再生されます。 動画ファイルの判断は拡張子によって行なっています。</p><p>MP3形式、およびASF形式はOSがサポートしている場合にのみ再生が可能です。 (初期のWindows95、Windows98ではWindows Media Player 5.2以降がインストールされている必要があります。)</p><p>実際の再生は、mmplay命令によって行ないます。</p><p><strong>参照</strong>:</p><p>mmplay mmstop</p><p><strong>対応の補足</strong>:</p><p>HSPLet時、WAV/AIFF/AU/MIDI/MP3 をサポートしています。 MP3の再生には付属の jl1.0.jar が必要です。</p><h2 id="mmstop" tabindex="-1">mmstop <a class="header-anchor" href="#mmstop" aria-label="Permalink to &quot;mmstop {#mmstop}&quot;">​</a></h2><p>メディア再生の停止</p><p><strong>グループ</strong>:</p><p>マルチメディア制御命令</p><p><strong>パラメーター</strong>:</p><p>p1 p1=0〜(-1) : メディアバッファID</p><p><strong>説明</strong>:</p><p>mmplay命令によるメディア再生を停止します。 p1でメディアバッファIDを指定することで、指定したメディアの再生を停止することができます。 p1を省略するかマイナス値が指定された場合は、すべてのメディア再生を停止します。</p><p><strong>参照</strong>:</p><p>mmplay mmload</p><h2 id="mmvol" tabindex="-1">mmvol <a class="header-anchor" href="#mmvol" aria-label="Permalink to &quot;mmvol {#mmvol}&quot;">​</a></h2><p>音量の設定</p><p><strong>グループ</strong>:</p><p>拡張マルチメディア制御命令</p><p><strong>パラメーター</strong>:</p><p>p1,p2 p1=0〜(0) : メディアバッファID p2(0) : ボリューム(音量)値(-1000〜0)</p><p><strong>説明</strong>:</p><p>mmplay命令によって再生されるメディアの音量を設定します。 ボリューム値は、0が最大の音量、-1000が無音状態となります。 このパラメーターはデフォルトで0(最大)が設定されています。 ※HSP3Dish環境でのみ利用できます ※ボリューム値は、dmmvol命令と同様にマイナス値が大きいほど無音に近づきます。 ただし、dmmvol命令は-10000〜0までのデシベル値であるのに対して、mmvol命令は-1000〜0までのリニアな変化 (聴感上の音量)を行なう値であることに注意してください。</p><p><strong>参照</strong>:</p><p>mmplay</p><h2 id="mmpan" tabindex="-1">mmpan <a class="header-anchor" href="#mmpan" aria-label="Permalink to &quot;mmpan {#mmpan}&quot;">​</a></h2><p>パンニングの設定</p><p><strong>グループ</strong>:</p><p>拡張マルチメディア制御命令</p><p><strong>パラメーター</strong>:</p><p>p1,p2 p1=0〜(0) : メディアバッファID p2(0) : パンニング値(-1000〜1000)</p><p><strong>説明</strong>:</p><p>mmplay命令によって再生されるメディアのパンニング(ステレオの左右バランス)を設定します。 -1000が最も左の定位、1000が最も右の定位の値となります。(0が中央の定位となります) このパラメーターはデフォルトで0(中央)が設定されています。 ※HSP3Dish環境でのみ利用できます ※Windows上でのmp3ファイルによる音楽再生時は反映されません ※dmmpan命令とは値の分解能が異なるので注意してください</p><p><strong>参照</strong>:</p><p>mmplay</p><h2 id="mmstat" tabindex="-1">mmstat <a class="header-anchor" href="#mmstat" aria-label="Permalink to &quot;mmstat {#mmstat}&quot;">​</a></h2><p>メディアの状態取得</p><p><strong>グループ</strong>:</p><p>拡張マルチメディア制御命令</p><p><strong>パラメーター</strong>:</p><p>p1,p2,p3 p1 : 状態が取得される変数 p2(0) : メディアバッファID p3(0) : 取得モード</p><p><strong>説明</strong>:</p><p>mmplay命令によって再生されるメディアの状態を取得して、p1の変数に代入します。 p3で取得するモードを指定することができます。 取得モードの値は、以下の通りです。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">モード値  内容</span></span>
<span class="line"><span style="color:#e1e4e8;">	------------------------------------------------------</span></span>
<span class="line"><span style="color:#e1e4e8;">	    0     設定フラグ値</span></span>
<span class="line"><span style="color:#e1e4e8;">	    1     ボリューム値</span></span>
<span class="line"><span style="color:#e1e4e8;">	    2     パンニング値</span></span>
<span class="line"><span style="color:#e1e4e8;">	    3     再生レート(0=オリジナル)</span></span>
<span class="line"><span style="color:#e1e4e8;">	    16    再生中フラグ(0=停止中/1=再生中)</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">※再生中フラグはHSP3Dish環境でのみ利用できます</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">モード値  内容</span></span>
<span class="line"><span style="color:#24292e;">	------------------------------------------------------</span></span>
<span class="line"><span style="color:#24292e;">	    0     設定フラグ値</span></span>
<span class="line"><span style="color:#24292e;">	    1     ボリューム値</span></span>
<span class="line"><span style="color:#24292e;">	    2     パンニング値</span></span>
<span class="line"><span style="color:#24292e;">	    3     再生レート(0=オリジナル)</span></span>
<span class="line"><span style="color:#24292e;">	    16    再生中フラグ(0=停止中/1=再生中)</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">※再生中フラグはHSP3Dish環境でのみ利用できます</span></span></code></pre></div><p><strong>参照</strong>:</p><p>mmplay</p>`,98),o=[l];function t(c,i,r,m,d,g){return a(),p("div",null,o)}const y=s(e,[["render",t]]);export{h as __pageData,y as default};
